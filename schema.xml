<?xml version="1.0" encoding="UTF-8"?>
<Schema name="hs">
    <Cube name="hs_rev2007_yearly_data">
        <Table name="hs_rev2007_yearly_data" schema="hs" />

        <Dimension name="year" type="TimeDimension">
           <Hierarchy hasAll="true" primaryKey="year">
               <Level column="year" name="year" levelType="TimeYears" type="Numeric" uniqueMembers="true" />
           </Hierarchy>
        </Dimension>

        <Dimension name="Origin Country">
           <Hierarchy hasAll="true" primaryKey="reporter_iso">
               <Level column="reporter_iso" name="reporter_iso" />
           </Hierarchy>
        </Dimension>

        <Dimension name="Destination Country">
           <Hierarchy hasAll="true" primaryKey="partner_iso">
               <Level column="partner_iso" name="partner_iso" />
           </Hierarchy>
        </Dimension>

        <Dimension name="Product">
           <Hierarchy hasAll="true" primaryKey="commodity_code">
               <Level column="commodity_code" name="commodity_code" />
           </Hierarchy>
        </Dimension>

        <Measure name="Exports" column="export_usd" aggregator="sum" />
        <Measure name="Imports" column="import_usd" aggregator="sum" />
        <Measure name="Export_kg" column="export_kg" aggregator="sum" />
        <Measure name="Import_kg" column="import_kg" aggregator="sum" />

        <CalculatedMember dimension="Measures" name="cpy_rca_b_pop" visible="false">
          <Formula>
            <![CDATA[
                (Measures.[Exports], [year].[year].CurrentMember,
        [Origin Country].[Countries].CurrentMember,
        [Destination Country].[Countries].[All Countriess],
        [Product].[HS07].[All HS07s])
            ]]>
          </Formula>
        </CalculatedMember>


        <CalculatedMember dimension="Measures" name="cpy_rca_c_pop" visible="false">
          <Formula>
            <![CDATA[
                (Measures.[Exports], [year].[year].CurrentMember,
        [Origin Country].[Countries].[All Countriess],
        [Destination Country].[Countries].[All Countriess],
        [Product].[HS07].CurrentMember)
            ]]>
          </Formula>
        </CalculatedMember>


        <CalculatedMember dimension="Measures" name="cpy_rca_d_pop" visible="false">
          <Formula>
            <![CDATA[
                (Measures.[Exports], [year].[year].CurrentMember,
        [Origin Country].[Countries].[All Countriess],
        [Destination Country].[Countries].[All Countriess],
        [Product].[HS07].[All HS07s])
            ]]>
          </Formula>
        </CalculatedMember>


        <CalculatedMember dimension="Measures" name="cpy RCA" visible="true">
          <Formula>
            <![CDATA[
            IIF([Measures].[cpy_rca_c_pop] > 0 and [Measures].[cpy_rca_d_pop] > 0,
             ([Measures].[Exports] / [Measures].[cpy_rca_b_pop]) /
             ([Measures].[cpy_rca_c_pop] / [Measures].[cpy_rca_d_pop])
             , NULL)
            ]]>
          </Formula>
        </CalculatedMember>

    </Cube>
</Schema>
